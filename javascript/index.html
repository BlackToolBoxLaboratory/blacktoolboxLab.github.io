<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" type="text/css" href="./libs/fontawesome/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="./style/index.css">
    <link rel="stylesheet" type="text/css" href="./style/pages/index.css">

    <link rel="icon" href="favicon.ico" type="image/x-icon" />
    <title>BTB Lab. | JavaScript </title>
    <meta name="google-site-verification" content="XjkUm8M885lvmNSs9BKe9khMCQY99rSfGsN3Tf6yfBY" />

    <meta property="og:title" content="Black Tool Box Laboratory | JavaScript"/> 
    <meta property="og:type" content="website"/> 
    <meta property="og:url" content="https://blacktoolboxlaboratory.github.io/javascript"/>
    <meta property="og:image" content=""/>
    <meta name="description" property="og:description" content="Here are some components based on pure JavaScript which made by Black Tool Box Laboratory."/> 
    
    <meta property="fb:app_id" content="271733690121245"/>

    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:site" content="@vannoel0628" />
    <meta name="twitter:creator" content="@vannoel0628" />
  </head>
  <body id="main">
    <header class="main_header padding-sm">
      <div class="header_logo margin-sm radius-md">
        <div class="logo_content font-4xl font-bold">
          BJ
        </div>
      </div>
      <div class="header_title margin-sm">
        <div class="title_main main-md font-bold font-xl">
          Black Tool Box Laboratory
        </div>
        <div class="title_main main-sm font-bold font-xl">
          BTB Lab.
        </div>
        <div class="title_sub">
          For JavaScript
        </div>
      </div>
      <div id="homepage_opener" class="header_menu font-xl margin-sm" onclick="redirectHomepage()">
        <i class="fas fa-home fa-fw"></i>
      </div>
      <div id="language_selector" class="header_menu font-xl margin-sm" onclick="openLangSeletor()">
        <i class="fas fa-globe fa-fw"></i>
      </div>
      <div id="menu_trigger" class="header_menu font-xl margin-sm" onclick="triggerMenu()">
        <i class="fas fa-bars fa-fw"></i>
      </div>
    </header>

    <div id="body" class="main_body">
      <iframe id="page" class="body_iframe" src=""></iframe>
      <aside id="menu_container" class="body_aside padding-y-lg"></aside>
    </div>

    <script type="text/javascript" src="./libs/prototype-languages/index.min.js"></script>
    <script type="text/javascript" src="./libs/jquery/jquery.min.js"></script>
    <script type="text/javascript" src="./plugins/prototype-languages.js"></script>
    <script>
      const routeMap = [
        {
          id: "ABOUT",
          path: "about", 
          title:"About", 
          url: "./pages/about.html",
        },
        {
          id: "PACKAGES",
          path: "packages", 
          title: "Packages",
          children: [
            {
              id: "PACKAGES_LANGUAGES",
              path: "packages/languages",
              title: "Languages",
              url: "./pages/languages.html"
            },
            {
              id: "PACKAGES_VALIDATOR",
              path: "packages/validator",
              title: "Validator",
              url: "./pages/validator.html"
            }
          ]
        }
      ];
      const REG_HASH = /^#(.*)$/;
      const DEFAULT_ROUTE = 'about';
      const SIZE_MD = 768;

      function renderMenu() {
        var menu = "";
        menu = "<div class=\"aside_menu padding-x-lg\">";
        menu += renderMenuRecursive(0,routeMap);
        menu += "</div>"
        $("#menu_container").html(menu);
      }
      function renderMenuRecursive (layer, map) {
        var route = "";
        if(map && map.length > 0) {
          route += "<ul class=\"menu_layer layer-"+ layer +"\">";
          map.forEach(function(entry) {
            var paddingLeft = layer*16;
            var classActive = (REG_HASH.exec(window.location.hash) && entry.path === REG_HASH.exec(window.location.hash)[1])? 'route-active' : '';
            route += "<li class=\"layer_container\">";
              if(entry.children)
              {
                route += "<div id=\""+entry.id+"\" class=\"container_route route-submenu padding-y-sm\" onclick=\"triggerMenu('"+entry.id+"')\">";
                route += "<div class=\"route_title\" style=\"padding-left:"+paddingLeft+"px\">"+entry.title+"</div>";
                route += "<div class=\"route_collapsed transition-transform\"><i class=\"fas fa-caret-down fa-fw\"></i></div>";
                route += "</div>";
                route += renderMenuRecursive(layer+1, entry.children);
              } else {
                route += "<div id=\""+entry.id+"\" class=\"container_route route-endNode padding-y-sm\" onclick=\"redirectHash('"+entry.path+"')\">";
                route += "<div class=\"route_title\" style=\"padding-left:"+paddingLeft+"px\">"+entry.title+"</div>";
                route += "</div>";
              }
            route += "</li>";
          });
          route += "</ul>";
        };
        return route;
      };
      function redirectURL(path) {
        var route = searchRouteRecursive(path, routeMap);
        $('.container_route').removeClass("route-active");
        $('#'+route.id).addClass("route-active");
        $("#page").attr("src", route.url);
      }
      function searchRouteRecursive(path, source) {
        for(var i=0;i<source.length;i++)
        {
          if(source[i].path === path) {
            return source[i];
          } else if (path.search(source[i].path)===0) {
            if(source[i].children && source[i].children.length>0)
            {
              return searchRouteRecursive(path, source[i].children);
            } else {
              return source[i];
            }
          }
        }
        return {};
      }
      function triggerMenu(id, state) {
        var target_collapse = $($('#'+id).children(".route_collapsed"));
        var target_layer = $('#'+id).siblings(".menu_layer");
        switch(state) {
          case "off":
            target_collapse.removeClass("collapsed-on");
            target_layer.stop().slideDown();
            break;
          case "on":
            target_collapse.addClass("collapsed-on");
            target_layer.stop().slideUp();
            break;
          default:
            if(target_collapse.hasClass("collapsed-on")) {
              triggerMenu(id, 'on');
            } else {
              triggerMenu(id, 'off');
            }
            break;
        }
      }
      function redirectHash(path) {
        window.location.hash = "#"+ path;
      }
      function configHashRouter(target) {
        if(!target.location.hash)
        {
          target.location.hash = '#' + DEFAULT_ROUTE;
          redirectURL(DEFAULT_ROUTE);
        } else {
          redirectURL(REG_HASH.exec(target.location.hash)[1]);
        }
      }
      function redirectHomepage() {
        location.href = location.origin + location.pathname;
      }
      function openLangSeletor() {
        
      }
      function triggerMenu(state) {
        switch(state) {
          case 'hide':
            $("#body").addClass("menu-hidden");
            break;
          case 'show':
            $("#body").removeClass("menu-hidden");
            break;
          default:
            if($("#body").hasClass("menu-hidden")) {
              triggerMenu('show');
            } else {
              triggerMenu('hide');
            }
            break;
        }
      }
      function loadEvent () {
        window.onhashchange=function(event){
          configHashRouter(event.target);
          if(window.innerWidth < SIZE_MD) {
            triggerMenu('hide');
          }
        }
      };

      $(document).ready(function(){
        if(window.innerWidth < SIZE_MD) {
          $("#body").addClass("menu-hidden");
        }
        renderMenu();
        configHashRouter(window);
        loadEvent();
      });
    </script>
  </body>
</html>